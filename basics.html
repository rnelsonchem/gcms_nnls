<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basics of working with GCMS data files &mdash; gcmstools 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="gcmstools 0.1.0 documentation" href="index.html" />
    <link rel="next" title="Non-negative Least Squares Fitting" href="fitting.html" />
    <link rel="prev" title="Getting started and installation" href="intro.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="fitting.html" title="Non-negative Least Squares Fitting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Getting started and installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">gcmstools 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="basics-of-working-with-gcms-data-files">
<h1>Basics of working with GCMS data files<a class="headerlink" href="#basics-of-working-with-gcms-data-files" title="Permalink to this headline">¶</a></h1>
<div class="section" id="export-the-data">
<h2>Export the data<a class="headerlink" href="#export-the-data" title="Permalink to this headline">¶</a></h2>
<p>First of all, be sure to export your GCMS data in a common data format, such
as <a class="reference external" href="http://en.wikipedia.org/wiki/Mass_spectrometry_data_format#ANDI-MS_or_netCDF">AIA, ANDI, or CDF.</a> It turns out that all of these formats <a class="reference external" href="https://www.unidata.ucar.edu/support/help/MailArchives/netcdf/msg05748.html">are related</a>
in that they are all based off of Network Common Data Format (<a class="reference external" href="http://en.wikipedia.org/wiki/NetCDF">netCDF</a>), so
they may have the file extension &#8220;AIA&#8221; or &#8220;CDF&#8221;. This file type may not be the
default for your instrument, so consult the documentation for your GCMS
software to determine how to export your data in these formats.</p>
</div>
<div class="section" id="set-up-the-processing-environment">
<h2>Set up the processing environment<a class="headerlink" href="#set-up-the-processing-environment" title="Permalink to this headline">¶</a></h2>
<p>In order to process these files, run IPython from a terminal (command prompt
in Windows) in the folder containing the &#8220;gcms.py&#8221; file (which is the base
folder for this repository).  There are (at least) two ways to do this that
involve the command <tt class="docutils literal"><span class="pre">cd</span></tt> (change directory) run from either the terminal or
an IPython session. For example (<tt class="docutils literal"><span class="pre">home&gt;$</span></tt> is the command prompt located in
the folder &#8220;home&#8221;, <tt class="docutils literal"><span class="pre">In:</span></tt> is the IPython prompt):</p>
<div class="code highlight-python"><div class="highlight"><pre>home&gt;$ ipython
In: %cd &quot;path-to-gcms-folder&quot;
Out: path-to-gcms-folder
In:
</pre></div>
</div>
<p>or:</p>
<div class="code highlight-python"><div class="highlight"><pre>home&gt;$ cd path-to-gcms-folder
gcms&gt;$ ipython
In:
</pre></div>
</div>
<p>The &#8220;<em>path-to-gcms-folder</em>&#8221; is a valid path to the folder with &#8220;gcms.py&#8221;. It
can take a little practice, but this gets easier very quickly. I&#8217;ll assume you
use the second form of this as it makes using the <a class="reference external" href="http://ipython.org/notebook.html">IPython notebook</a> much
easier later.</p>
</div>
<div class="section" id="read-aia-data-files">
<h2>Read AIA data files<a class="headerlink" href="#read-aia-data-files" title="Permalink to this headline">¶</a></h2>
<p>First of all, you will need to <tt class="docutils literal"><span class="pre">import</span></tt> the &#8220;gcms.py&#8221; file to make the code
accessible to the IPython environment. This file contains a class called
<tt class="docutils literal"><span class="pre">AIAFile</span></tt> that reads and processes the GCMS files. AIAFile takes one
argument, which is a string with the file name. This string must have the path
(i.e.  folder) information if the file is not in the same directory as
&#8220;gcms.py&#8221;.  Sample data files are contained in a folder called &#8220;data&#8221;.</p>
<div class="code highlight-python"><div class="highlight"><pre>In: import gcms
In: data = gcms.AIAFile(&#39;data/datasample1.CDF&#39;)
</pre></div>
</div>
<p>The variable <tt class="docutils literal"><span class="pre">data</span></tt> now contains our processed GCMS data set. You can see
its contents using tab completion in IPython (<tt class="docutils literal"><span class="pre">&lt;tab&gt;</span></tt> refers to the tab
key).</p>
<div class="code highlight-python"><div class="highlight"><pre>In: data.&lt;tab&gt;
data.filename data.intensity data.nnls data.ref_build data.times
data.integrate data.masses data.tic
</pre></div>
</div>
<p>All of these attributes are either data that describe or functions that modify
(methods) our dataset. You can inspect these attributes very easily in
IPython by just typing the name at the prompt.</p>
<div class="code highlight-python"><div class="highlight"><pre>In: data.times
Out:
array([0.08786667, ..., 49.8351])
In: data.tic
Out:
array([158521., ..., 0.])
</pre></div>
</div>
<p>This is a short description of these initial attributes:</p>
<ul class="simple">
<li><em>filename</em>: This is the name of the file that you imported.</li>
<li><em>times</em>: A Numpy array of the times that each MS was collected.</li>
<li><em>tic</em>: A Numpy array of the total ion chromatogram intensities.</li>
<li><em>masses</em>: A Numpy array the masses that cover the data collected by the MS.</li>
<li><em>intensity</em>: This is the 2D Numpy array of raw MS intensity data. The
columns correspond to the masses in the <tt class="docutils literal"><span class="pre">masses</span></tt> array and the rows
correspond to the times in the <tt class="docutils literal"><span class="pre">times</span></tt> array.</li>
</ul>
<p>The remaining attributes <em>ref_build</em>, <em>nnls</em>, and <em>integrate</em> are functions
that deal with the non-negative fitting routine and are covered in later
sections.</p>
</div>
<div class="section" id="simple-plotting">
<h2>Simple plotting<a class="headerlink" href="#simple-plotting" title="Permalink to this headline">¶</a></h2>
<p>We can easily plot these data using the plotting package Matplotlib. As an
example, let&#8217;s try plotting the total ion chromatogram. In this case,
<tt class="docutils literal"><span class="pre">data.times</span></tt> will be our &#8220;x-axis&#8221; data, and <tt class="docutils literal"><span class="pre">data.tic</span></tt> will be our &#8220;y-axis&#8221;
data.</p>
<div class="code highlight-python"><div class="highlight"><pre>In: import matplotlib.pyplot as plt
In: plt.plot(data.times, data.tic)
Out:
[&lt;matplotlib.lines.Line2D at 0x7f34&gt;]
In: plt.show()
</pre></div>
</div>
<p>This should produce a pop-up window with an interactive plot, <a href="#ticplot">Figure  1</a>.  (This should process should be fairly quick. However, sometimes
the plot initially appears behind the other windows, which makes it seem like
things are stuck. Be sure to scroll through your windows to find it.)</p>
<div class="figure" id="ticplot">
<a class="reference internal image-reference" href="_images/tic.png"><img alt="_images/tic.png" src="_images/tic.png" style="width: 3.5in;" /></a>
<p class="caption">Figure 1: Total ion chromatogram.</p>
</div>
<p>One drawback here is that you have to type these commands every time you want
to see this plot. There is another alternative, though. You can also put all
of these commands into a text file and run it with Python directly. Copy the
following code into a plain text file called &#8220;tic_plot.py&#8221;.</p>
<p><strong>NOTE</strong>: it is very important that you are using a plain text file and not a
word processing (MS Word) document. On Mac/Linux, the &#8221;.py&#8221; suffix is not
required; however, in Windows, this suffix can be important. Unfortunately,
Windows hides file extentions by default, so you may have to search the web to
determine how to enable display of file extensions. Otherwise, you might end
up with a file called &#8220;tic_plot.py.txt&#8221;, which can work, but will most likely
cause confusion and annoyance. Anaconda ships with Spyder, a Python
development editor, which will take care of all of this for you, so you might
want to familiarize yourself with that program.</p>
<div class="code highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">gcms</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">gcms</span><span class="o">.</span><span class="n">AIAFile</span><span class="p">(</span><span class="s">&#39;data/datasample1.CDF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>It is common practice to do all imports at the top of a Python program. That
way it is clear exactly what code is being brought into play. Run this new
file using the <tt class="docutils literal"><span class="pre">python</span></tt> command from the terminal.</p>
<div class="code highlight-python"><div class="highlight"><pre>gcms&gt;$ python tic_plot.py
</pre></div>
</div>
<p>The window with your plot will now appear. (You will not be able to work in the
terminal until you close this window.) Alternatively, you can run this program
directly from IPython.</p>
<div class="code highlight-python"><div class="highlight"><pre>gcms&gt;$ ipython
In: %run tic_plot.py
</pre></div>
</div>
<p>This also pops open a new window containing the interactive plot. It has the
advantage, however, that once the window is closed, you are dropped back into
an IPython session that &#8220;remembers&#8221; all of the variables and imports that you
created in your program file. In our example above, once the plot window is
closed, your IPython session will have <tt class="docutils literal"><span class="pre">gcms</span></tt>, <tt class="docutils literal"><span class="pre">plt</span></tt>, and <tt class="docutils literal"><span class="pre">data</span></tt> (our
GCMS AIA file) available.  This is very useful if you want to continue to work
interactively with your data, and it is a great way to remove a bunch of
repetitive typing.</p>
</div>
<div class="section" id="working-with-multiple-data-sets">
<h2>Working with multiple data sets<a class="headerlink" href="#working-with-multiple-data-sets" title="Permalink to this headline">¶</a></h2>
<p>In the example above, we opened our dataset into a variable called <tt class="docutils literal"><span class="pre">data</span></tt> in
order to be able to plot the TIC. If you want to manipulate more than one data
set, the procedure is exactly the same, except that you will need to use
different variable names for your other data sets.</p>
<div class="code highlight-python"><div class="highlight"><pre>In: data2 = gcms.AIAFile(&#39;data/datasample2.CDF&#39;)
</pre></div>
</div>
<p>These two data sets can be plot together on the same figure by doing the
following:</p>
<div class="code highlight-python"><div class="highlight"><pre>In: plt.plot(data.times, data.tic)
Out:
[&lt;matplotlib.lines.Line2D at 0x7f34&gt;]
In: plt.plot(data2.times, data2.tic)
Out:
[&lt;matplotlib.lines.Line2D at 0x02e3&gt;]
In: plt.show()
</pre></div>
</div>
<p>The window shown in <a href="#twotic">Figure  2</a> should appear on the screen. (There
is a blue and green line here that are a little hard to see in this picture.
Zoom in on the plot to see the differences.)</p>
<div class="figure" id="twotic">
<a class="reference internal image-reference" href="_images/tic2.png"><img alt="_images/tic2.png" src="_images/tic2.png" style="width: 3.5in;" /></a>
<p class="caption">Figure 2: Two tic plotted together</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basics of working with GCMS data files</a><ul>
<li><a class="reference internal" href="#export-the-data">Export the data</a></li>
<li><a class="reference internal" href="#set-up-the-processing-environment">Set up the processing environment</a></li>
<li><a class="reference internal" href="#read-aia-data-files">Read AIA data files</a></li>
<li><a class="reference internal" href="#simple-plotting">Simple plotting</a></li>
<li><a class="reference internal" href="#working-with-multiple-data-sets">Working with multiple data sets</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Getting started and installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fitting.html"
                        title="next chapter">Non-negative Least Squares Fitting</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/basics.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="fitting.html" title="Non-negative Least Squares Fitting"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Getting started and installation"
             >previous</a> |</li>
        <li><a href="index.html">gcmstools 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Ryan Nelson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>